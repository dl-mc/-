<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Redirecting...</title>
<script src="https://cdn.jsdelivr.net/npm/pako@2.1.0/dist/pako.min.js"></script>
<style>
body { background:white; margin:0; }
</style>
</head>
<body>

<script>
// Domain shortcuts with trailing slash
const DOMAINS = {
  "yt": "https://www.youtube.com/",
  "mf": "https://www.mirrored.to/files/"
};

// URL-safe Base64 decode
function base64UrlDecode(str) {
  str = str.replace(/-/g, '+').replace(/_/g, '/');
  while (str.length % 4) str += '=';
  const binary = atob(str);
  const u8arr = new Uint8Array(binary.length);
  for (let i = 0; i < binary.length; i++) u8arr[i] = binary.charCodeAt(i);
  return u8arr;
}

// Get which domain parameter exists
const params = new URLSearchParams(window.location.search);
let domainCode = null, encodedStr = null;
for (let key of params.keys()) {
  if (DOMAINS[key]) {
    domainCode = key;
    encodedStr = params.get(key);
    break;
  }
}

if (domainCode && encodedStr) {
  try {
    const compressed = base64UrlDecode(encodedStr);
    const pathPart = new TextDecoder().decode(pako.inflate(compressed));
    const finalURL = DOMAINS[domainCode] + pathPart;
    if (finalURL.startsWith("http")) window.location.replace(finalURL);
  } catch(e) { console.error("Invalid code", e); }
}
</script>

</body>
</html>
