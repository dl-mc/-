<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Link Encoder</title>
<script src="https://cdn.jsdelivr.net/npm/pako@2.1.0/dist/pako.min.js"></script>
<style>
body {
  background:#0f172a;
  color:white;
  font-family:Arial;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  margin:0;
}
.box {
  background:#1e293b;
  padding:20px;
  border-radius:10px;
  width:400px;
  text-align:center;
}
input {
  width:100%;
  padding:10px;
  border:none;
  border-radius:6px;
  margin-bottom:10px;
}
button {
  width:100%;
  padding:10px;
  border:none;
  border-radius:6px;
  background:#38bdf8;
  font-weight:bold;
  cursor:pointer;
}
#output {
  margin-top:12px;
  word-break:break-all;
}
</style>
</head>
<body>

<div class="box">
  <h2>Encode Link</h2>
  <input id="input" placeholder="Paste link here">
  <button onclick="encode()">Generate Link</button>
  <p id="output"></p>
</div>

<script>
// Domain shortcuts with trailing slash
const DOMAINS = [
  { code: "yt", prefix: "https://www.youtube.com/" },
  { code: "mf", prefix: "https://www.mirrored.to/files/" }
];

// Convert Uint8Array â†’ BigInt, then base36
function uint8ToBase36(u8arr) {
  let hex = Array.from(u8arr, b => b.toString(16).padStart(2,'0')).join('');
  return BigInt('0x' + hex).toString(36);
}

function encode() {
  let link = document.getElementById("input").value.trim();
  if (!link) return alert("Enter a link first!");

  // Check domain shortcuts
  let domainParam = "";
  let pathPart = link;
  for (let d of DOMAINS) {
    if (link.startsWith(d.prefix)) {
      domainParam = d.code;
      pathPart = link.slice(d.prefix.length);
      break;
    }
  }
  if (!domainParam) return alert("Unknown domain. Only yt and mf supported.");

  // Compress path/query only
  const compressed = pako.deflate(pathPart);
  const encoded = uint8ToBase36(compressed);

  // Generate link with domain-specific query parameter
  const finalLink = `https://dl-mc.github.io/-/?${domainParam}=${encoded}`;

  const output = document.getElementById("output");
  output.innerHTML = `<a href="${finalLink}" target="_blank" style="color:#38bdf8;">Open Link</a>`;
}
</script>

</body>
</html>
