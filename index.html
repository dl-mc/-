<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Redirecting...</title>
<script src="https://cdn.jsdelivr.net/npm/pako@2.1.0/dist/pako.min.js"></script>
<style>
  body { background:white; margin:0; }
</style>
</head>
<body>

<script>
// Domain shortcuts with trailing slash
const DOMAINS = {
  "yt": "https://www.youtube.com/",
  "mf": "https://www.mirrored.to/files/"
};

// Get code+encoded from URL
const fullEncoded = new URLSearchParams(window.location.search).get("d") || "";

// Split domain code (first 2 letters) and remaining
const domainCode = fullEncoded.slice(0, 2);
const encodedPart = fullEncoded.slice(2);

// Decode URL-safe Base64
function decodeSafeBase64(str) {
  str = str.replace(/-/g,"+").replace(/_/g,"/");
  while (str.length % 4) str += "=";
  return atob(str);
}

// Decompress
function decompress(str) {
  const compressed = Uint8Array.from(str.split("").map(c=>c.charCodeAt(0)));
  return new TextDecoder().decode(pako.inflate(compressed));
}

// Redirect
if (encodedPart) {
  try {
    const decompressed = decompress(decodeSafeBase64(encodedPart));
    const domainPrefix = DOMAINS[domainCode] || "";
    const finalURL = domainPrefix + decompressed;
    if (finalURL.startsWith("http")) {
      setTimeout(()=>{ window.location.replace(finalURL); }, 200);
    }
  } catch(e) { console.error("Invalid code", e); }
}
</script>

</body>
</html>
