<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Redirecting...</title>
<script src="https://cdn.jsdelivr.net/npm/pako@2.1.0/dist/pako.min.js"></script>
<style>
body { background:white; margin:0; }
</style>
</head>
<body>

<script>
// Domain shortcuts with trailing slash
const DOMAINS = {
  "yt": "https://www.youtube.com/",
  "mf": "https://www.mirrored.to/files/"
};

// Convert Base36 string â†’ Uint8Array
function base36ToUint8(str) {
  let hex = BigInt('0x'+parseInt(str,36).toString(16)).toString(16);
  if (hex.length % 2) hex = '0'+hex;
  const arr = [];
  for (let i = 0; i < hex.length; i += 2) arr.push(parseInt(hex.slice(i,i+2),16));
  return new Uint8Array(arr);
}

// Get which domain parameter exists
const params = new URLSearchParams(window.location.search);
let domainCode = null, encodedStr = null;
for (let key of params.keys()) {
  if (DOMAINS[key]) {
    domainCode = key;
    encodedStr = params.get(key);
    break;
  }
}

if (domainCode && encodedStr) {
  try {
    const compressed = base36ToUint8(encodedStr);
    const pathPart = new TextDecoder().decode(pako.inflate(compressed));
    const finalURL = DOMAINS[domainCode] + pathPart;
    if (finalURL.startsWith("http")) window.location.replace(finalURL);
  } catch(e) { console.error("Invalid code", e); }
}
</script>

</body>
</html>
